<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="kr.co.hkcloud.palette3.chat.setting.dao.ChatSettingImageManageMapper">

    
<!--  CLOB SELECT -->
<resultMap id="mapSelectRtnImgMngClob" type="java.util.HashMap" >
		<result property="BRD_ID" 			column="BRD_ID" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="BRD_NO" 			column="BRD_NO" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="BRD_TIT" 			column="BRD_TIT" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="BRD_RMK" 			column="BRD_RMK" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FST_USER_ID" 		column="FST_USER_ID" 	jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FST_BRD_DT" 		column="FST_BRD_DT" 	jdbcType="VARCHAR"  javaType="java.lang.String"/>
		<result property="LAST_USER_ID" 	column="LAST_USER_ID" 	jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="LAST_BRD_DT" 		column="LAST_BRD_DT" 	jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="ACCESS_IP" 		column="ACCESS_IP" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="SELECT_NO" 		column="SELECT_NO" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="ORD_SEQ" 			column="ORD_SEQ" 		jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="USE_YN"    		column="USE_YN"      	jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="PROC_ID"      	column="PROC_ID"       	jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="IT_PROCESSING"	column="IT_PROCESSING"  jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FILE_GROUP_KEY"   column="FILE_GROUP_KEY" jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FILE_KEY"      	column="FILE_KEY"       jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FILE_NM"      	column="FILE_NM"       	jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="REAL_UPLOAD_NM"   column="REAL_UPLOAD_NM" jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FILE_PATH"      	column="FILE_PATH"      jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="TASK_TYPE_CD"      	column="TASK_TYPE_CD"      jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FILE_SZ"      	column="FILE_SZ"      jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="FILE_EXTN"      	column="FILE_EXTN"      jdbcType="VARCHAR" 	javaType="java.lang.String"/>
		<result property="DWNLD_CNT"      	column="DWNLD_CNT"      jdbcType="VARCHAR" 	javaType="java.lang.String"/>
</resultMap>                              
<!-- 이미지 게시판 목록 조회  -->
<select id="selectRtnImgMng" parameterType="java.util.HashMap" resultMap="mapSelectRtnImgMngClob">

	SELECT ROW_TBL.*
     FROM (  
			SELECT
				ROW_NUMBER() OVER(ORDER BY FST_BRD_DT DESC) AS ROW_NUMBER 
				 , B.CUSTCO_ID									AS CUSTCO_ID		  /* 회사구분 */	
				 , B.BRD_ID                                         AS BRD_ID             /*  통합게시판ID */
			     , B.BRD_NO                                         AS BRD_NO             /* 게시물번호*/
			     , B.BRD_TIT                                        AS BRD_TIT            /*  게시물제목 */
			     , B.BRD_RMK                                        AS BRD_RMK            /*  게시물내용 */
			     , B.FST_USER_ID                                    AS FST_USER_ID        /*  최초등록자ID */
			     , TO_CHAR(B.FST_BRD_DT, 'YYYY/MM/DD HH24:MI:SS')   AS FST_BRD_DT         /*  최초등록일 */
			     , TO_CHAR(B.FST_BRD_DT, 'YYYY/MM/DD')   			AS FST_BRD_DT_D       /*  최초등록일 시분초제거 */
			     , B.LAST_USER_ID                                   AS LAST_USER_ID       /*  마지막등록자ID */
			     , TO_CHAR(B.LAST_BRD_DT, 'YYYY/MM/DD HH24:MI:SS')  AS LAST_BRD_DT        /*  마지막등록일 */
			     , B.ACCESS_IP                                      AS ACCESS_IP          /*  등록자IP */
			     , B.SELECT_NO                                      AS SELECT_NO          /*  조회수 */
			     , B.ORD_SEQ                                        AS ORD_SEQ            /*  정렬순서 */
			     , B.USE_YN                                         AS USE_YN             /*  사용여부 */
			     , B.PROC_ID                                        AS PROC_ID            /*  처리자 */
			     , TO_CHAR(B.IT_PROCESSING, 'YYYY/MM/DD HH24:MI:SS')AS IT_PROCESSING      /*  전산처리일시 */
			     , F.FILE_GROUP_KEY                                 AS FILE_GROUP_KEY     /*  파일그룹키 */
			     , F.FILE_KEY                                       AS FILE_KEY           /*  파일키 */
			     , F.TASK_TYPE_CD                                      AS TASK_TYPE_CD          /*  업무구분 */
			     , F.PATH_TYPE_CD                                      AS PATH_TYPE_CD          /*  파일경로 */
			     , F.ACTL_FILE_NM                              AS FILE_NM            /*  파일명 */
			     , F.FILE_PATH                                      AS FILE_PATH
           		 , F.STRG_FILE_NM                                  AS STRG_FILE_NM
			  FROM PLT_BLBD_MST B
			  LEFT OUTER JOIN PLT_FILE F
                ON B.FILE_GROUP_KEY = F.FILE_GROUP_KEY
			 WHERE B.CUSTCO_ID = #{ASP_NEWCUST_KEY}
			   AND F.CUSTCO_ID = #{ASP_NEWCUST_KEY}
			   AND B.BRD_ID = #{BRD_ID}
			   AND B.USE_YN = 'Y'
			<if test="START_DT !='' and START_DT != null">
			<![CDATA[
			   AND LAST_BRD_DT >= TO_DATE(#{START_DT} || '000000', 'YYYYMMDDHH24MISS')
			]]>
			</if>
			<if test="END_DT !='' and END_DT != null">
			<![CDATA[
			   AND LAST_BRD_DT <= TO_DATE(#{END_DT} || '235959', 'YYYYMMDDHH24MISS')
			]]>
			</if>
			<if test="BRD_TIT !='' and BRD_TIT != null">
			   AND BRD_TIT LIKE '%' || #{BRD_TIT} || '%'
			</if>

			 ORDER BY FST_BRD_DT DESC
	 ) ROW_TBL
	 

</select>

</mapper>