buildscript {
    ext {
		//springBootVersion = '2.3.12.RELEASE'	// Spring Boot v2.5.15.RELEASE, Spring v5.2.15.RELEASE, Tomcat 9.0.x
        springBootVersion = '2.5.15'	// Spring Boot v2.5.15, Spring v5.3.27, Tomcat 9.0.x
    }

    repositories {
        mavenCentral()
    }

    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
        classpath "io.spring.gradle:dependency-management-plugin:1.1.0"
    }
}


allprojects {
	group = 'kr.co.hkcloud.palette3'
	version = '2.0.100-SNAPSHOT'
}

subprojects {
	apply plugin: 'org.springframework.boot'
    apply plugin: 'io.spring.dependency-management'
    apply plugin: 'eclipse'
    apply plugin: 'java'

	sourceCompatibility = "17"

	configurations {
		developmentOnly
		runtimeClasspath {
			extendsFrom developmentOnly
		}
		compileOnly {
			extendsFrom annotationProcessor
		}
		// exclude Tomcat
		//compile.exclude module: 'spring-boot-starter-tomcat'
	}

	repositories {
		jcenter()
		mavenLocal()
		mavenCentral()
	    maven {
			url 'https://maven.egovframe.go.kr/maven/'
		}
		maven {
			url 'https://jitpack.io'
		}
    }

    // 해당 task로 서브 모듈 추가시 기초적인 디렉토리를 자동으로 생성해줍니다.
    task initSourceFolders {
        sourceSets*.java.srcDirs*.each {
            if (!it.exists()) {
                it.mkdirs()
            }
        }

        sourceSets*.resources.srcDirs*.each {
            if (!it.exists()) {
                it.mkdirs()
            }
        }
    }

    sourceSets.main.resources {
		srcDirs += ["src/main/java"];
		exclude "**/*.java"
	}

	bootJar {
		manifest {
	        attributes("Implementation-Title": "${project.name}",
	                   "Implementation-Version": "${project.version}")
	    }
	}

	ext {
		set('springBootAdminVersion', "2.3.0")
	}

	dependencies {
		//use okhhttp3
		implementation("com.squareup.okhttp3:okhttp:4.9.1")
		implementation 'org.springframework.boot:spring-boot-starter-cache'
		//use view template
		implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
		//use web
		implementation('org.springframework.boot:spring-boot-starter-web')
		//use validation with 2.3
		implementation 'org.springframework.boot:spring-boot-starter-validation'
		//use websocket
		implementation 'org.springframework.boot:spring-boot-starter-websocket'
		//use mail
	    implementation 'org.springframework.boot:spring-boot-starter-mail'
		//implementation 'javax.websocket:javax.websocket-api'
		//for security
		implementation 'org.springframework.boot:spring-boot-starter-security'
		implementation 'org.springframework.security:spring-security-messaging'
		implementation 'com.github.ulisesbocchio:jasypt-spring-boot-starter:3.0.3'
		//support spring-security5
		implementation 'org.thymeleaf.extras:thymeleaf-extras-springsecurity5'

		//spring-mok
	    implementation 'org.springframework:spring-mock:2.0.8'
		//for developers
		//use lombok
		compileOnly 'org.projectlombok:lombok:1.18.22'
		annotationProcessor 'org.projectlombok:lombok:1.18.22'
		testCompileOnly 'org.projectlombok:lombok:1.18.22' // 테스트 의존성 추가
		testAnnotationProcessor 'org.projectlombok:lombok:1.18.22' // 테스트 의존성 추가

		developmentOnly 'org.springframework.boot:spring-boot-devtools'
		annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'
		testImplementation('org.springframework.boot:spring-boot-starter-test') {
			exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'
		}
		testImplementation 'org.springframework.security:spring-security-test'
		//mybatis sql pretty
		implementation 'org.bgee.log4jdbc-log4j2:log4jdbc-log4j2-jdbc4.1:1.16'
		//Swagger2 사용
		implementation "io.springfox:springfox-boot-starter:3.0.0"
		implementation "io.springfox:springfox-swagger-ui:3.0.0"

		//postgreSQL
		implementation 'org.postgresql:postgresql:42.6.0'
		//use mybatis
		implementation 'org.mybatis.spring.boot:mybatis-spring-boot-starter:2.1.3'
		//with redis
		implementation 'org.springframework.boot:spring-boot-starter-data-redis'
		//use jpa
		implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
		//use jooq
		//jooq와 aop execution 버그로 느려짐 현상 있음 - 20190810
		//implementation 'org.springframework.boot:spring-boot-starter-jooq'
		//with egovframework idgnr
		//spring boot logging, logback과 충돌하므로 제외 처리
		implementation('egovframework.rte:egovframework.rte.fdl.idgnr:3.8.0') {
			exclude group: 'org.apache.logging.log4j', module: 'log4j-slf4j-impl'
			exclude group: 'org.slf4j', module: 'slf4j-log4j12'
			exclude group: 'org.slf4j', module: 'log4j-over-slf4j'
			exclude group: 'org.apache.logging.log4j', module: 'log4j-api'
		}
		//commons-configuration
		implementation 'commons-configuration:commons-configuration:1.10'
		//commons-fileupload
		implementation 'commons-fileupload:commons-fileupload:1.4'
		//commons-lang3
		implementation 'org.apache.commons:commons-lang3:3.0'
		//httpclient
		implementation 'org.apache.httpcomponents:httpclient:4.5.13'
		//httpmime
		implementation 'org.apache.httpcomponents:httpmime'
		//Apache Tika is a toolset that detects and extracts metadata and text from a variety of files. It has a rich and powerful API and comes with tika-core which we can make use of, for detecting MIME type of a file.
        implementation 'org.apache.tika:tika-core:1.26'
		//json-lib-jdk15
		implementation 'net.sf.json-lib:json-lib:2.4:jdk15'
		//gson
		implementation 'com.google.code.gson:gson:2.8.1'
		//jcodec - support video
		implementation 'org.jcodec:jcodec:0.1.9'
		implementation 'org.jcodec:jcodec-javase:0.1.9'
        //for excel
        //jxl
        implementation 'net.sourceforge.jexcelapi:jxl:2.6.12'
        //poi
        //https://poi.apache.org/components/index.html#components
        //implementation 'org.apache.poi:poi:4.1.2'
        implementation 'org.apache.poi:poi:5.0.0'
        //poi-ooxml
        //implementation 'org.apache.poi:poi-ooxml:4.1.2'
        implementation 'org.apache.poi:poi-ooxml:5.0.0'
        //UA for excel
        //https://github.com/HaraldWalker/user-agent-utils
        implementation 'eu.bitwalker:UserAgentUtils:1.21'
        //icu4j - ChineseCalendar
        implementation 'com.ibm.icu:icu4j:4.6'
		//with webjar - https://webjars.org v20190921
	    implementation 'org.webjars:jquery:3.4.1'
	    //sha256 - https://mvnrepository.com/artifact/org.webjars.npm/js-sha256
		implementation 'org.webjars.npm:js-sha256:0.7.1'
		//spring-websocket stomp
		implementation 'org.webjars:bootstrap:4.3.1'
	    implementation 'org.webjars:vue:2.5.16'
	    implementation 'org.webjars:stomp-websocket:2.3.3-1'
	    implementation 'org.webjars:sockjs-client:1.1.2'
	    implementation 'org.webjars.bower:axios:0.17.1'
	    //support es6 promise
	    implementation 'org.webjars.bower:es6-promise:4.2.4'
	    implementation 'org.webjars.npm:url-search-params-polyfill:7.0.0'

	    // jwt 관련 의존성_Arthur.Kim
		implementation group: 'io.jsonwebtoken', name: 'jjwt-api', version: '0.11.2'
		implementation group: 'io.jsonwebtoken', name: 'jjwt-impl', version: '0.11.2'
		implementation group: 'io.jsonwebtoken', name: 'jjwt-jackson', version: '0.11.2'

		implementation 'org.apache.commons:commons-pool2:2.11.1'
		implementation 'org.apache.commons:commons-dbcp2:2.9.0'
		implementation 'org.springframework.boot:spring-boot-starter-actuator'

		//implementation 'org.springframework.cloud:spring-cloud-starter-netflix-hystrix:2.2.5.RELEASE'

		//+++++++++++++++++++++++++++++++++++++++++++++++++++ 스프링클라우드용.
//		implementation 'org.springframework.cloud:spring-cloud-starter-netflix-hystrix:2.2.5.RELEASE'
//		implementation 'org.springframework.cloud:spring-cloud-starter-netflix-ribbon:2.2.5.RELEASE'
//		implementation 'org.springframework.cloud:spring-cloud-starter-netflix-eureka-client:2.2.5.RELEASE'
//
//		implementation 'org.springframework.cloud:spring-cloud-starter-config:2.2.5.RELEASE'
//		implementation 'org.springframework.cloud:spring-cloud-starter-bus-amqp:2.2.3.RELEASE'
//		implementation 'org.springframework.boot:spring-boot-starter-actuator'
		//+++++++++++++++++++++++++++++++++++++++++++++++++++

//		implementation 'org.java-websocket:Java-WebSocket:1.5.1'

		//멀티테넌시(multitenancy) 처리 : flyway 관련
		implementation group: 'org.flywaydb', name: 'flyway-core', version: '9.15.1'

		implementation 'com.googlecode.json-simple:json-simple:1.1.1' // 원하는 버전으로 변경

		implementation group: 'org.springframework.boot', name: 'spring-boot-starter-webflux'
		implementation group: 'org.mindrot', name: 'jbcrypt', version: '0.4'

	}
	
	dependencyManagement {
		imports {
			mavenBom "de.codecentric:spring-boot-admin-dependencies:${springBootAdminVersion}"
		}
	}
	
	//test {
	//	useJUnitPlatform()
	//}
	
	[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'
}

